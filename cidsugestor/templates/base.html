<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cid Sugestor</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='main.css') }}"
    />
  </head>

  <body class="bg-light">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="card shadow form-card p-4">
            <h1 class="text-center mb-2">
              <i class="bi bi-clipboard2-pulse"></i> Cid Sugestor
            </h1>
            <p class="text-center text-muted mb-4">
              Insira uma anamnese e receba automaticamente uma sugestão de CID
            </p>

            <form id="cid-form" method="POST" action="">
              {{ form_base.csrf_token }}

              <label for="texto" class="form-label fw-semibold">Anamnese</label>
              <textarea
                class="form-control custom-textarea"
                id="texto"
                name="texto"
                rows="10"
                placeholder="Descreva os sintomas, histórico e queixas do paciente..."
                required
              ></textarea>
              <div class="d-grid mt-4">
                <button
                  type="submit"
                  id="submit-btn"
                  class="btn btn-primary btn-lg"
                >
                  <i class="bi bi-search-heart"></i> Sugerir CID
                </button>
              </div>
              <div id="loading" class="text-center mt-3" style="display: none">
                <div class="spinner-border text-primary" role="status"></div>
                <p class="text-muted mt-2">Gerando sugestão...</p>
              </div>
            </form>

            {% if response_gemini is not none %}
            <div class="alert alert-info mt-4">
              <h5>✨ Resposta do Gemini:</h5>
              <p class="mb-0">{{ response_gemini }}</p>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      const form = document.getElementById("cid-form");
      const loading = document.getElementById("loading");
      const submitBtn = document.getElementById("submit-btn");

      form.addEventListener("submit", () => {
        submitBtn.disabled = true;
        loading.style.display = "block";
      });
    </script>
  </body>
</html>
